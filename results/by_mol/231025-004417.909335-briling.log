namespace(experiment_name='final-cv', wandb_name='cv10-LP-cyclo-noH-ns64-nv48-d48-layers3-energy-mlp-both-rxnmapper', device='cuda', logdir='/scratch/izar/briling/cv', checkpoint=None, CV=1, num_epochs=512, seed=123, verbose=False, process=False, subset=None, max_neighbors=10, n_s=64, n_v=48, n_conv_layers=3, distance_emb_dim=48, radius=2.5, dropout_p=0.05, attention=None, sum_mode='both', graph_mode='energy', dataset='cyclo', combine_mode='mlp', atom_mapping=True, rxnmapper=True, random_baseline=False, two_layers_atom_diff=True, noH=True, reverse=False, split_complexes=False, xtb=False, semiempirical=False, lr=0.0005, weight_decay=0.0001)

namespace(experiment_name=None, wandb_name=None, device='cuda', logdir='logs/evaluation', checkpoint='/home/briling/scratch/cv/final-cv-cyclo/231004-153924.653083-briling.best_checkpoint.pt', CV=1, num_epochs=223, seed=123, verbose=False, process=False, subset=None, max_neighbors=10, n_s=64, n_v=48, n_conv_layers=3, distance_emb_dim=48, radius=2.5, dropout_p=0.05, attention=None, sum_mode='both', graph_mode='energy', dataset='cyclo', combine_mode='mlp', atom_mapping=True, rxnmapper=True, random_baseline=False, two_layers_atom_diff=True, noH=True, reverse=False, split_complexes=False, xtb=False, semiempirical=False, lr=0.0005, weight_decay=0.0001, eval_on_test_split=True)

Running on device cuda:0
dataset_prefix='cyclo.rxn_smiles_rxnmapper.noH.v6'
Loading data into memory...
Coords and graphs successfully read from data/cyclo/processed//
Data stdev 9.7495

CV iter 1/1
Using random splits
total / train / test / val: 5265 4738 263 264
trainable params in model:  10383318
Log directory: logs/evaluation
checkpoint: /home/briling/scratch/cv/final-cv-cyclo/231004-153924.653083-briling.best_checkpoint.pt
num epochs: 223
eval_per_epochs: 0
patience: 150
minimum_epochs: 0
models_to_save: []
clip_grad: 100
log_iterations: 100
lr: 0.0005
weight decay: 0.0001
lr scheduler: <class 'torch.optim.lr_scheduler.ReduceLROnPlateau'>
factor: 0.6
min_lr: 8e-06
mode: max
lr_scheduler_patience: 60
lr_verbose: True
In trainer, metrics is {'mae': MAE()} and std is 9.749544941439076
Statistics on val_best_checkpoint
mae: 2.3222145146916895
MSELoss: 0.10454087710064469
mean_pred: 0.07140551936445814
std_pred: 0.9774780715956832
mean_targets: 0.07679443648367217
std_targets: 1.0336712643955692
Evaluating on test, with test size:  263
Statistics on test_split_1
mae: 2.654369334290943
MSELoss: 0.14522231240389924
mean_pred: 0.056705552971724305
std_pred: 0.9755994912349817
mean_targets: 0.04491105969205047
std_targets: 1.0000618307879476
>>> 3427 0.9854133 0.54333067
>>> 2969 -0.48986357 -0.42968494
>>> 1507 -0.118455514 -0.5668228
>>> 1873 -1.2048843 -1.6501173
>>> 4602 1.2649848 1.2718866
>>> 4313 -0.7359227 -0.8644028
>>> 3891 1.0824869 1.3910389
>>> 389 1.0824761 0.6597055
>>> 1734 -0.5248551 -0.32524616
>>> 3741 -0.19380455 -0.3743177
>>> 762 -1.1459903 -0.8121868
>>> 3708 -1.0989676 -1.4562262
>>> 1406 0.96783936 1.6426175
>>> 2884 0.078315385 0.19589506
>>> 329 -0.18394378 -0.70563453
>>> 2397 0.079619505 0.26269674
>>> 4763 -1.0380843 -0.8822096
>>> 3753 4.2243543 3.1092029
>>> 4118 -0.3551441 -0.4299642
>>> 34 -0.8850752 -1.1751857
>>> 3348 -1.6992149 -1.4490151
>>> 821 0.62422055 0.5674282
>>> 1438 -0.4904013 -0.55882704
>>> 287 -0.73073024 -0.6674089
>>> 2414 -1.3387135 -1.2161664
>>> 5260 -0.59079504 -0.42068952
>>> 4628 0.86913526 1.0645567
>>> 3943 0.43094942 0.47174135
>>> 4943 -1.0056231 -0.9733052
>>> 2161 2.1892185 2.2019947
>>> 2040 -0.39464545 -0.31778532
>>> 1656 0.7718347 1.1338891
>>> 4102 0.86050844 1.0278463
>>> 2989 -0.24927124 -0.14987127
>>> 581 -0.79960346 -0.36650705
>>> 1104 0.52041733 0.7065793
>>> 2080 -1.3161067 -0.41008946
>>> 2412 -1.1536646 -0.9443267
>>> 1439 -0.5633702 -0.6649721
>>> 1684 0.17579384 -0.18054886
>>> 2240 2.4692314 2.3810441
>>> 1558 -0.12675881 0.0642561
>>> 4277 0.21259287 0.18526977
>>> 4310 -0.3180282 -0.6080292
>>> 2533 -1.1659393 -0.34915292
>>> 1146 -0.72407186 -0.62172866
>>> 2856 1.9130968 1.411915
>>> 4454 -0.58361924 -0.58590233
>>> 416 0.3344546 1.1210111
>>> 3796 -0.33325037 -1.1114728
>>> 1602 -0.29616007 0.0828805
>>> 3356 -0.16566099 -0.5557412
>>> 4692 -0.65213645 -0.6257381
>>> 4993 0.23447768 0.31369352
>>> 3458 0.9054166 1.1783334
>>> 2478 -0.7151388 0.0011677127
>>> 2495 -0.45305735 -0.62514055
>>> 3518 -0.2240947 -0.16864285
>>> 5068 0.42654705 0.35322598
>>> 3866 1.800198 1.4516237
>>> 60 0.1453533 0.23630631
>>> 2255 -0.50973004 -0.3207493
>>> 788 1.4696931 0.6022916
>>> 1118 -0.16407719 -1.0202093
>>> 4384 -1.4179078 -1.3430879
>>> 1792 2.6479695 2.4259076
>>> 4104 0.95539653 0.88585794
>>> 713 -0.65285057 -0.16814522
>>> 3561 1.2462696 1.776278
>>> 4864 0.57211405 0.47679475
>>> 4823 -0.80591583 -0.3937966
>>> 3727 0.8149332 0.76112926
>>> 2301 0.6740353 0.69770896
>>> 5034 0.59148645 0.6921682
>>> 3881 1.067551 1.1709899
>>> 936 -1.0131942 -0.8921589
>>> 455 -0.7084833 -0.10572687
>>> 538 -2.0819807 -1.66152
>>> 874 0.41173407 0.3804094
>>> 268 -1.0423062 -0.58584595
>>> 3815 -0.9400258 -1.2448105
>>> 545 -0.3392587 -0.097618505
>>> 2388 -0.89385873 0.15402943
>>> 5187 1.3367939 1.0265415
>>> 1551 0.6048203 1.2211668
>>> 1258 -0.4096565 -0.4817027
>>> 413 0.64435947 0.9923266
>>> 4923 0.81618345 0.4575224
>>> 4011 0.3855116 0.32273918
>>> 5006 3.3586092 3.3850312
>>> 4496 -0.04389019 -0.06548127
>>> 3556 -1.2309418 -1.1993781
>>> 3527 0.115157485 -0.43298435
>>> 93 0.36529642 0.3026407
>>> 1524 -0.52504843 -0.45335507
>>> 1007 0.56860334 0.4031703
>>> 2359 0.8517769 0.6681224
>>> 2023 0.86092716 0.67805374
>>> 2566 0.42706263 0.670829
>>> 126 0.7298825 1.0063035
>>> 2201 -0.534558 -0.3155937
>>> 5124 1.240775 1.1003238
>>> 443 0.60317254 0.5516155
>>> 4938 2.8083868 2.5205762
>>> 3132 -0.086897515 -0.27545875
>>> 2578 -0.22242504 -0.012347079
>>> 3095 -0.08774574 -0.3833347
>>> 3860 0.15853563 0.37690806
>>> 4321 -0.4383016 -0.4593307
>>> 3072 -0.63700783 -1.0460355
>>> 3656 -1.6025225 -1.3734977
>>> 1649 0.6768874 0.5923913
>>> 2483 -0.52018505 0.10964984
>>> 2227 -0.5221689 -0.1300353
>>> 1647 0.86279935 0.7212504
>>> 434 -1.047715 -1.330802
>>> 508 -0.85811704 -0.9184735
>>> 4030 0.6077257 0.38564253
>>> 32 -0.5955355 -0.8679335
>>> 2378 -0.7314043 -0.85521877
>>> 2072 0.9554861 -0.2308324
>>> 4295 0.4805775 0.5967699
>>> 2880 -0.104431055 -0.10947135
>>> 3895 0.43495166 0.21472935
>>> 3367 1.5858333 1.9448414
>>> 2819 0.7826891 0.41385618
>>> 180 -0.8510063 -0.8027905
>>> 2871 -0.2739499 -0.44166452
>>> 1282 -0.9522805 -0.6439645
>>> 5213 3.1486168 3.2788203
>>> 2046 -0.9065249 -1.0208691
>>> 4360 -0.8300339 -0.23946369
>>> 2174 -0.64907783 -0.39143264
>>> 4391 0.95099247 1.2622112
>>> 719 -0.81877595 -0.8521353
>>> 3892 -0.40650415 -0.6212317
>>> 295 -1.0126419 -0.85675985
>>> 3963 -0.8863114 -0.8778668
>>> 794 0.17252013 -0.08167083
>>> 4756 2.4466553 2.9698346
>>> 3665 -0.9118003 -0.75813925
>>> 4591 2.298724 2.4768696
>>> 4201 -0.8030521 -0.575822
>>> 3143 -0.8748716 -0.8144954
>>> 3306 -0.8075995 -0.77499557
>>> 2395 -0.25683013 -0.42477718
>>> 4841 0.08862804 0.2063995
>>> 922 0.15353237 -0.032222472
>>> 4007 2.2204604 2.8116908
>>> 2467 0.5246872 0.48593274
>>> 2557 1.8430104 1.2906051
>>> 3121 1.0890626 3.3070648
>>> 1326 0.28108397 0.6281911
>>> 5015 2.2072477 1.9869006
>>> 3273 1.184379 1.3235012
>>> 4765 -0.3995782 0.024792261
>>> 915 -1.1135755 -1.2325385
>>> 1425 -0.8721462 -1.1509069
>>> 231 -0.9382221 -0.6897416
>>> 2778 -1.5255634 -1.0907078
>>> 1474 -1.3552707 -0.5979784
>>> 1221 -0.7471962 -0.9371132
>>> 2751 -0.32799447 0.3966038
>>> 2917 -0.11810782 -0.2564003
>>> 1100 -0.7850239 -0.8585744
>>> 1257 -0.6603512 -0.5553511
>>> 1888 -0.13042824 -0.3342007
>>> 1922 -0.7744876 -0.31293282
>>> 687 -0.5633804 -0.52826375
>>> 5090 -1.525454 -0.9272883
>>> 2599 -0.5717533 -0.9734085
>>> 2795 0.0918363 0.21502641
>>> 4063 1.7279608 1.9343456
>>> 4703 0.48772874 0.6305493
>>> 3092 1.0007716 1.6172245
>>> 4904 0.7123427 0.72205555
>>> 4636 0.31645447 0.23963448
>>> 4028 1.3167495 1.0194021
>>> 2625 -0.95792514 -0.52578545
>>> 89 0.4374601 0.34625617
>>> 2446 -0.15745026 0.28265047
>>> 113 -0.6479383 -0.8109392
>>> 1235 0.39691412 0.40331924
>>> 3476 -0.7432795 -0.6757273
>>> 2936 0.18682653 0.25132617
>>> 191 -0.6031506 -0.71028316
>>> 3839 0.19065048 -0.058140773
>>> 2341 -0.49323034 -0.6771403
>>> 2945 -1.5404946 -1.5979505
>>> 16 -1.481951 -2.1307046
>>> 5053 -1.5997279 -1.1744605
>>> 3295 -0.7824881 -1.1101506
>>> 4344 -0.17594704 -0.16799565
>>> 3261 -0.43556464 -0.6082064
>>> 3463 1.00464 -0.3259318
>>> 1760 -0.8717825 -0.72516257
>>> 4166 0.8144187 0.18162052
>>> 2747 -0.88440424 -0.55320793
>>> 4254 0.9611274 0.73200893
>>> 1557 0.28128636 0.4081419
>>> 2159 2.4096243 2.015132
>>> 1755 -0.25129682 -0.047793545
>>> 3178 0.34251603 0.45789993
>>> 1871 0.7388451 0.45821473
>>> 1759 -0.70780104 -0.8283643
>>> 4867 -1.4370874 -0.9696016
>>> 3486 -0.16106483 -0.6470984
>>> 1312 -0.91509414 -1.0516831
>>> 2425 1.5198538 0.1256251
>>> 2999 -0.96374947 -0.43232378
>>> 4050 -1.2514888 -1.4217144
>>> 672 0.5731096 -0.080248505
>>> 3310 0.5672021 -0.07493962
>>> 4462 2.8452923 3.4771948
>>> 3034 -0.8160722 -0.7747083
>>> 4610 2.1884248 2.2137294
>>> 1248 -0.82479984 -0.7902337
>>> 1794 1.133099 0.9615376
>>> 4947 -1.2046875 -1.0425045
>>> 2213 1.1214687 1.3445941
>>> 2654 0.660169 0.29607746
>>> 1662 -0.7343415 -0.6647954
>>> 1128 -1.3053776 -1.0407075
>>> 3200 -0.8356322 -0.72418904
>>> 5236 0.5745594 0.8469246
>>> 3918 0.38709608 0.34709492
>>> 2289 1.2945144 1.8462341
>>> 845 0.3371095 0.54613215
>>> 3655 0.29316455 0.24449736
>>> 2010 -0.14096348 -0.22983581
>>> 3940 -1.4787211 -0.9777215
>>> 3078 -1.6118894 -1.664851
>>> 4994 0.43318433 0.48173243
>>> 1427 1.3787518 1.0844128
>>> 2270 -0.53172576 -0.3111483
>>> 4645 0.8876004 1.1281614
>>> 1105 0.6337734 0.36817604
>>> 361 -0.7956073 -0.821712
>>> 892 0.5586905 0.48073664
>>> 2574 1.2210029 0.562351
>>> 4541 1.0764499 1.0251527
>>> 1061 -0.41127494 -0.65023464
>>> 4576 0.7761711 0.32503435
>>> 4736 -1.2621337 -1.2028587
>>> 4721 1.0016744 1.2650704
>>> 14 0.32229695 0.26623
>>> 2666 1.4857376 1.08045
>>> 1543 -1.2251798 -0.9776565
>>> 1378 -0.94246113 -0.5391148
>>> 3622 0.3639305 0.0643469
>>> 3539 -0.73182577 -0.3777793
>>> 3084 0.17540514 -0.015861096
>>> 3230 0.47859722 0.30722058
>>> 464 -0.72558933 -0.713916
>>> 3358 0.80648726 0.48076862
>>> 4501 0.7480878 0.64192504
>>> 2490 0.02491854 0.07939867
>>> 4550 -0.60981584 -0.47825512
>>> 4725 0.23812722 -0.26792544
>>> 609 -1.3097639 -1.425473
>>> 2637 -0.31165734 -0.31497258
>>> 133 -1.1240059 -1.1578526
>>> 4097 1.120926 0.6565912

Mean MAE across splits 2.654369334290943 +- 0.0
delta MAE: 7.04e-08
